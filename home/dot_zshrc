# Completions
fpath=($HOME/.docker/completions $fpath)
autoload -Uz compinit
compinit

# fzf (fuzzy finder)
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# fzf-tab (must be AFTER compinit, BEFORE autosuggestions)
source "$HOMEBREW_PREFIX/opt/fzf-tab/share/fzf-tab/fzf-tab.zsh"

# zoxide (smarter cd)
eval "$(zoxide init zsh)"

# Autosuggestions
source "$HOMEBREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh"

# Fast syntax highlighting (must be near the end of plugin loading)
source "$HOMEBREW_PREFIX/opt/zsh-fast-syntax-highlighting/share/zsh-fast-syntax-highlighting/fast-syntax-highlighting.plugin.zsh"

# Starship (prompt)
eval "$(starship init zsh)"

# mise (runtime version manager)
eval "$(mise activate zsh)"

# thefuck (command correction)
eval $(thefuck --alias)

# Aliases
alias vim=nvim

# Git helpers
gcnov() {
  git commit --no-verify $@
}

gpsu() {
  git push --set-upstream origin $(git branch --show-current) $@
}

grtg() {
  git tag -d "$1"
  git tag "$1"
  git push origin -f "$1"
}

# Ghostty tab title (append to Ghostty's hooks to guarantee running last)
_ghostty_title_hook() {
  if (( $+functions[_ghostty_precmd] )); then
    functions[_ghostty_precmd]+='
      builtin print -Pn "\e]0;%1~\a"'
    functions[_ghostty_preexec]+='
      builtin print -Pn "\e]0;%1~\a"'
    print -Pn "\e]0;%1~\a"
    add-zsh-hook -d precmd _ghostty_title_hook
  fi
}
autoload -Uz add-zsh-hook
add-zsh-hook precmd _ghostty_title_hook
