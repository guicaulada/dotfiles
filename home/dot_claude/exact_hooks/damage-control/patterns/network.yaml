# Network security patterns (curl/wget exfiltration, SSH, encryption/signing, network config, data transfer)
bashToolPatterns:
  # ===========================================================================
  # BLOCK PATTERNS (no "ask" key = exit code 2)
  # ===========================================================================

  # ---------------------------------------------------------------------------
  # Remote code execution
  # ---------------------------------------------------------------------------
  - pattern: '\b(curl|wget)\b.*\|\s*(sh|bash|zsh|python3?|perl\d*|ruby\d*)\b'
    reason: curl/wget piped to shell (remote code execution)

  # ---------------------------------------------------------------------------
  # Network data exfiltration (curl / wget)
  # ---------------------------------------------------------------------------
  - pattern: '\bcurl\b.*\s+(-d\b|--data\b|--data-\w+|-F\b|--form\b|--upload-file)\s*'
    reason: curl with data/form/file upload (potential data exfiltration)

  - pattern: '\bcurl\b.*-X\s+(POST|PUT|PATCH|DELETE)\b'
    reason: curl with mutating HTTP method (potential data exfiltration)

  - pattern: '\bwget\b.*--post-data\s+'
    reason: wget with POST data (potential data exfiltration)

  # ---------------------------------------------------------------------------
  # Reverse shells / listeners
  # ---------------------------------------------------------------------------
  - pattern: '\b(nc|ncat|netcat)\s+.*(-[a-z]*l[a-z]*\b|--listen)\b'
    reason: netcat listen mode (potential reverse shell)

  - pattern: '\bsocat\b.*(LISTEN|listen)'
    reason: socat listen mode (potential reverse shell)

  # ---------------------------------------------------------------------------
  # Firewall (destructive operations)
  # ---------------------------------------------------------------------------
  - pattern: '\biptables-restore\b'
    reason: iptables-restore (replaces entire firewall ruleset)

  - pattern: '\bip6tables\s+.*(-F|--flush)\b'
    reason: ip6tables flush (removes all IPv6 firewall rules)

  - pattern: '\bufw\s+(disable|reset|delete)\b'
    reason: ufw firewall disable/reset/delete

  - pattern: '\bnft\s+(flush|delete)\b'
    reason: nftables flush/delete (removes firewall rules)

  # ---------------------------------------------------------------------------
  # Network configuration (destructive)
  # ---------------------------------------------------------------------------
  - pattern: '\bip\s+(addr|route|link|rule)\s+(add|del|change|replace|flush)\b'
    reason: ip command modifying network configuration

  - pattern: '\bifconfig\s+\S+\s+(down|up)\b'
    reason: ifconfig interface state change

  - pattern: '\broute\s+(add|del|delete|change)\b'
    reason: route table modification

  - pattern: '\bsysctl\s+(-w|--write)\b'
    reason: sysctl write (modifies kernel parameters)

  # ---------------------------------------------------------------------------
  # Remote data destruction
  # ---------------------------------------------------------------------------
  - pattern: '\brclone\s+(delete|purge)\b'
    reason: rclone delete/purge (destroys remote data)

  # ===========================================================================
  # ASK PATTERNS (ask: true = prompt for confirmation)
  # ===========================================================================

  # ---------------------------------------------------------------------------
  # Network reconnaissance
  # ---------------------------------------------------------------------------
  - pattern: '\bnmap\b'
    reason: Network scanner (reconnaissance tool)
    ask: true

  - pattern: '\btcpdump\b'
    reason: Captures network traffic (potential credential capture)
    ask: true

  # ---------------------------------------------------------------------------
  # Firewall (individual rule changes)
  # ---------------------------------------------------------------------------
  - pattern: '\biptables\s+.*(-A|--append|-D|--delete|-I|--insert)\b'
    reason: Modifies individual firewall rules
    ask: true

  # ---------------------------------------------------------------------------
  # SSH operations
  # ---------------------------------------------------------------------------
  - pattern: '\bssh\b.*\S+@\S+\s+\S+'
    reason: SSH remote command execution
    ask: true

  - pattern: '\bssh-keygen\b'
    reason: SSH key generation (may overwrite existing keys)
    ask: true

  - pattern: '\bssh-add\b'
    reason: Loads private key into SSH agent
    ask: true

  # ---------------------------------------------------------------------------
  # Encryption / signing
  # ---------------------------------------------------------------------------
  - pattern: '\bgpg\s+--(encrypt|sign|clearsign|detach-sign)\b'
    reason: GPG encryption/signing operation
    ask: true

  - pattern: '\bopenssl\s+(genrsa|genpkey|req|x509|pkcs12)\b'
    reason: OpenSSL key/certificate generation
    ask: true

  # ---------------------------------------------------------------------------
  # Data transfer (remote)
  # ---------------------------------------------------------------------------
  - pattern: '\bscp\b.*\S+:\S+'
    reason: scp to remote host (potential data exfiltration)
    ask: true

  - pattern: '\brsync\s+.*\S+:\S+'
    reason: rsync to/from remote host
    ask: true

  - pattern: '\bsftp\b'
    reason: SFTP file transfer
    ask: true

  - pattern: '\b(ftp|tftp)\b'
    reason: Unencrypted file transfer protocol
    ask: true

  - pattern: '\bsocat\b'
    reason: socat (bidirectional data relay)
    ask: true

  - pattern: '\brclone\s+(copy|sync|move)\b'
    reason: rclone data transfer
    ask: true
