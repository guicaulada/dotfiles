# Package manager security patterns (registry, system, npm/yarn/pnpm, brew, pip, cargo, go, nix, snap, flatpak, asdf/mise/proto)
bashToolPatterns:
  # ---------------------------------------------------------------------------
  # PACKAGE REGISTRY DESTRUCTIVE OPERATIONS
  # ---------------------------------------------------------------------------
  - pattern: '\bnpm\s+unpublish\b'
    reason: npm unpublish (removes package from registry)

  - pattern: '\bnpm\s+deprecate\b'
    reason: npm deprecate (marks package as deprecated in registry)

  - pattern: '\bgem\s+yank\b'
    reason: gem yank (removes gem from RubyGems)

  - pattern: '\bcargo\s+yank\b'
    reason: cargo yank (yanks crate from crates.io)

  # ---------------------------------------------------------------------------
  # SYSTEM PACKAGE MANAGERS - REMOVAL (DESTRUCTIVE)
  # ---------------------------------------------------------------------------
  - pattern: '\bsudo\s+(apt|apt-get)\s+(remove|purge|autoremove)\b'
    reason: apt package removal (system-level)

  - pattern: '\bsudo\s+(dnf|yum)\s+(remove|erase|autoremove)\b'
    reason: dnf/yum package removal (system-level)

  - pattern: '\bsudo\s+pacman\s+-R'
    reason: pacman package removal (system-level)

  - pattern: '\bsudo\s+zypper\s+(remove|rm)\b'
    reason: zypper package removal (system-level)

  - pattern: '\bsudo\s+apk\s+del\b'
    reason: apk package removal (system-level)

  - pattern: '\b(snap\s+(remove|uninstall)|flatpak\s+uninstall)\b'
    reason: snap/flatpak package removal

  # ---------------------------------------------------------------------------
  # SYSTEM PACKAGE MANAGERS - INSTALLATION (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bsudo\s+(apt|apt-get)\s+install\b'
    reason: apt package installation (system-level)
    ask: true

  - pattern: '\bsudo\s+(dnf|yum)\s+install\b'
    reason: dnf/yum package installation (system-level)
    ask: true

  - pattern: '\bsudo\s+pacman\s+-S'
    reason: pacman package installation (system-level)
    ask: true

  - pattern: '\bsudo\s+zypper\s+(install|in)\b'
    reason: zypper package installation (system-level)
    ask: true

  - pattern: '\bsudo\s+apk\s+add\b'
    reason: apk package installation (system-level)
    ask: true

  # ---------------------------------------------------------------------------
  # HOMEBREW
  # ---------------------------------------------------------------------------
  - pattern: '\bbrew\s+(uninstall|remove)\b'
    reason: Uninstalls Homebrew package
    ask: true

  - pattern: '\bbrew\s+install\s+.*--force'
    reason: Homebrew force install (overwrites existing)
    ask: true

  - pattern: '\bbrew\s+reinstall\b'
    reason: Homebrew reinstall
    ask: true

  - pattern: '\bbrew\s+install\s+--cask\b'
    reason: Homebrew cask install (macOS application)
    ask: true

  - pattern: '\bbrew\s+(cleanup|autoremove)\b'
    reason: brew cleanup/autoremove (removes old versions or unused dependencies)
    ask: true

  # ---------------------------------------------------------------------------
  # PIP / GEM
  # ---------------------------------------------------------------------------
  - pattern: '\bpip3?\s+install\b'
    reason: pip install (arbitrary code execution from PyPI)
    ask: true

  - pattern: '\bpip\s+uninstall\b'
    reason: Uninstalls Python package
    ask: true

  - pattern: '\bgem\s+uninstall\b'
    reason: Uninstalls Ruby gem
    ask: true

  # ---------------------------------------------------------------------------
  # CARGO / GO
  # ---------------------------------------------------------------------------
  - pattern: '\bcargo\s+install\b'
    reason: cargo install (compiles and installs Rust binary)
    ask: true

  - pattern: '\bgo\s+install\b'
    reason: go install (downloads and installs Go binary)
    ask: true

  # ---------------------------------------------------------------------------
  # NIX ECOSYSTEM
  # ---------------------------------------------------------------------------
  - pattern: '\b(nix-collect-garbage|nix-store\s+--delete|nix\s+store\s+(gc|delete))\b'
    reason: Nix garbage collection / store deletion (removes Nix store paths)

  - pattern: '\b(nix-env\s+(\S+\s+)*-e|nix\s+profile\s+(remove|install))\b'
    reason: Nix profile modification (install/remove packages)
    ask: true

  # ---------------------------------------------------------------------------
  # PACKAGE REGISTRY PUBLISHING (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bnpm\s+publish\b'
    reason: Publishes package to npm registry
    ask: true

  # ---------------------------------------------------------------------------
  # NPM / YARN / PNPM / BUN - REMOTE EXECUTION (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\b(npx|bunx|yarn\s+dlx|pnpm\s+dlx)\b'
    reason: Downloads and executes arbitrary packages
    ask: true

  # ---------------------------------------------------------------------------
  # NPM / YARN / PNPM - GLOBAL INSTALLS (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bnpm\s+(install|i)\s+(-\S+\s+)*-g\b'
    reason: npm global install (modifies system-wide packages)
    ask: true

  - pattern: '\byarn\s+global\s+add\b'
    reason: yarn global install (modifies system-wide packages)
    ask: true

  - pattern: '\bpnpm\s+add\s+(-\S+\s+)*-g\b'
    reason: pnpm global install (modifies system-wide packages)
    ask: true

  # ---------------------------------------------------------------------------
  # NPM / YARN - LINKING (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\b(npm|yarn)\s+link\b'
    reason: npm/yarn link (creates global symlink)
    ask: true

  # ---------------------------------------------------------------------------
  # VERSION MANAGERS (asdf / mise / proto)
  # ---------------------------------------------------------------------------
  - pattern: '\basdf\s+uninstall\b'
    reason: asdf uninstall (removes language/tool version)

  - pattern: '\bmise\s+(uninstall|prune)\b'
    reason: mise uninstall/prune (removes tool versions)

  - pattern: '\bproto\s+(uninstall|clean)\b'
    reason: proto uninstall/clean (removes tool versions)
