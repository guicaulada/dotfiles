# Security patterns (credential managers, scheduled execution, misc)
bashToolPatterns:
  # ---------------------------------------------------------------------------
  # CREDENTIAL MANAGER COMMANDS (ALL ACCESS DENIED)
  # ---------------------------------------------------------------------------
  # Catch-all patterns: any subcommand to a credential manager is blocked.
  # This avoids maintaining long subcommand lists that inevitably go stale.

  - pattern: '\bpass\s+\S+'
    reason: pass (password-store) - credential manager access denied

  - pattern: '\bgopass\s+\S+'
    reason: gopass (password-store alternative) - credential manager access denied

  - pattern: '\bop\s+\S+'
    reason: 1Password CLI (op) - credential manager access denied

  - pattern: '\bvault\s+\S+'
    reason: HashiCorp Vault - credential manager access denied

  - pattern: '\bbw\s+\S+'
    reason: Bitwarden CLI (bw) - credential manager access denied

  - pattern: '\blpass\s+\S+'
    reason: LastPass CLI (lpass) - credential manager access denied

  - pattern: '\brbw\s+\S+'
    reason: Bitwarden CLI unofficial (rbw) - credential manager access denied

  - pattern: '\bdoppler\s+\S+'
    reason: Doppler (doppler) - secret manager access denied

  - pattern: '\bsecurity\s+(find-generic-password|find-internet-password|dump-keychain|show-keychain-info|find-certificate|find-identity)\b'
    reason: macOS Keychain read - credential manager access denied

  - pattern: '\bsecret-tool\s+'
    reason: GNOME Keyring (secret-tool) - credential manager access denied

  - pattern: '\bkwallet-query\b'
    reason: KDE Wallet (kwallet-query) - credential manager access denied

  # ---------------------------------------------------------------------------
  # CREDENTIAL / TOKEN EXPOSURE COMMANDS
  # ---------------------------------------------------------------------------
  - pattern: '\bgpg\s+--export-secret-(keys|subkeys)\b'
    reason: GPG secret key export (exposes private keys)

  # ---------------------------------------------------------------------------
  # ENVIRONMENT VARIABLE DUMPING (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bprintenv\s*($|\|)'
    reason: printenv dumps all environment variables (may contain secrets)
    ask: true

  - pattern: '\b(export\s+-p|declare\s+-x)\b'
    reason: Dumps all exported environment variables (may contain secrets)
    ask: true

  # ---------------------------------------------------------------------------
  # SCHEDULED EXECUTION REQUIRING CONFIRMATION (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bcrontab\s+[^-\s]'
    reason: Replaces entire crontab from file
    ask: true

  - pattern: '\b(at|batch)\b'
    reason: Schedules command for later execution
    ask: true

  # ---------------------------------------------------------------------------
  # MISCELLANEOUS
  # ---------------------------------------------------------------------------
  - pattern: '\bchmod\s+([ugoa]*\+s|[24][0-7]{3})\b'
    reason: chmod setuid/setgid (creates privilege escalation vector)

  - pattern: '\bchattr\b'
    reason: chattr (changes file attributes)
    ask: true

  - pattern: '\bsystemctl\s+(start|restart|enable|unmask)\b'
    reason: Starts/enables system service
    ask: true
