# GitHub CLI (gh) security patterns
bashToolPatterns:
  # ---------------------------------------------------------------------------
  # GITHUB CLI CREDENTIAL EXPOSURE
  # ---------------------------------------------------------------------------
  - pattern: '\bgh\s+auth\s+token\b'
    reason: gh auth token (exposes authentication token)

  - pattern: '\bgh\s+auth\s+status\b.*(-t\b|--show-token)'
    reason: gh auth status --show-token (exposes authentication token)

  # ---------------------------------------------------------------------------
  # GITHUB CLI DESTRUCTIVE OPERATIONS
  # ---------------------------------------------------------------------------
  - pattern: '\bgh\s+repo\s+(delete|archive|rename)\b'
    reason: gh repo delete/archive/rename (destructive repository operation)

  - pattern: '\bgh\s+release\s+delete\b'
    reason: gh release delete (deletes a release)

  # ---------------------------------------------------------------------------
  # GITHUB CLI OPERATIONS REQUIRING CONFIRMATION (ask: true)
  # ---------------------------------------------------------------------------
  - pattern: '\bgh\s+pr\s+(create|merge|close|reopen|review|comment|edit|ready)\b'
    reason: Mutating pull request operation
    ask: true

  - pattern: '\bgh\s+issue\s+(create|close|reopen|comment|edit|transfer|pin|unpin)\b'
    reason: Mutating issue operation
    ask: true

  - pattern: '\bgh\s+release\s+(create|edit)\b'
    reason: Mutating release operation
    ask: true

  - pattern: '\bgh\s+repo\s+(create|fork|edit)\b'
    reason: Mutating repository operation
    ask: true

  - pattern: '\bgh\s+label\s+(create|edit|delete)\b'
    reason: Mutating label operation
    ask: true

  - pattern: '\bgh\s+api\b.*(-X|--method)\s+(POST|PUT|PATCH|DELETE)\b'
    reason: gh api with write method (mutating API call)
    ask: true

  - pattern: '\bgh\s+workflow\s+(enable|disable|run)\b'
    reason: Mutating GitHub Actions workflow operation
    ask: true

  - pattern: '\bgh\s+run\s+(cancel|rerun|delete)\b'
    reason: Mutating GitHub Actions run operation
    ask: true

  - pattern: '\bgh\s+secret\s+(set|delete)\b'
    reason: Manages repository secrets
    ask: true

  - pattern: '\bgh\s+variable\s+(set|delete)\b'
    reason: Manages Actions variables
    ask: true

  - pattern: '\bgh\s+gist\s+create\b'
    reason: Creates a gist (potential data exposure)
    ask: true
