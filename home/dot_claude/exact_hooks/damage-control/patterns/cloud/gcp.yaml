# GCP (gcloud) security patterns
bashToolPatterns:
  # ---------------------------------------------------------------------------
  # CREDENTIAL EXPOSURE
  # ---------------------------------------------------------------------------
  - pattern: '\bgcloud\s+auth\s+print-(access-token|identity-token)\b'
    reason: GCP token exposure (prints authentication token)

  - pattern: '\bgcloud\s+auth\s+application-default\s+print-access-token\b'
    reason: GCP ADC token exposure (prints application default credentials token)

  # ---------------------------------------------------------------------------
  # SPECIFIC BLOCKS: patterns the catch-all would miss or only ask about
  # ---------------------------------------------------------------------------

  # gcloud storage rm -r uses "rm" not "delete"
  - pattern: '\bgcloud\s+storage\s+rm\s+.*-r'
    reason: gcloud storage rm -r (recursive delete)

  # "destroy" for secrets versions is caught by block catch-all, but "disable"
  # would only be caught by ask catch-all -- disabling a secret version must BLOCK
  - pattern: '\bgcloud\s+secrets\s+versions\s+disable\b'
    reason: gcloud secrets versions disable (irreversible secret version disable)

  # dataflow cancel/drain uses verbs not in the block catch-all
  - pattern: '\bgcloud\s+dataflow\s+jobs\s+(cancel|drain)\b'
    reason: gcloud dataflow jobs cancel/drain (stops data pipeline)

  # ---------------------------------------------------------------------------
  # SPECIFIC ASKS: patterns the catch-all misses or that need override behavior
  # ---------------------------------------------------------------------------

  # "start"/"stop"/"reset" are not in the block catch-all but should at
  # least prompt. The ask catch-all covers "create|update|deploy|..." but not
  # these state-change verbs for compute instances
  - pattern: '\bgcloud\s+compute\s+instances\s+(start|stop|reset)\b'
    reason: Changes GCE instance state
    ask: true

  # remove-iam-policy-binding and set-iam-policy use hyphens after the verb,
  # but these are caught by the ask catch-all since it uses \b word boundary.
  # However, add-iam-policy-binding is NOT in the ask catch-all verb list.
  - pattern: '\bgcloud\s+.*\badd-iam-policy-binding\b'
    reason: Adds IAM policy binding (grants permissions)
    ask: true

  # ---------------------------------------------------------------------------
  # BLOCK CATCH-ALL: any "gcloud ... delete" or "gcloud ... destroy"
  # ---------------------------------------------------------------------------
  - pattern: '\bgcloud\s+.*\b(delete|destroy)\b'
    reason: GCP CLI destructive operation (catch-all)

  # ---------------------------------------------------------------------------
  # ASK CATCH-ALL: any "gcloud ... create/update/deploy/..."
  # ---------------------------------------------------------------------------
  - pattern: '\bgcloud\s+.*\b(create|update|deploy|remove-iam-policy-binding|set-iam-policy)\b'
    reason: GCP CLI mutating operation (catch-all)
    ask: true
